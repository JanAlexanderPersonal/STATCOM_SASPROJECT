*    13. Write a pdf report with the ODS system of max 5 pages containing the following:
    • Names of the group members with a mentioning of who did what.
    • A short introduction on the topic.
    • Answers to the questions with requested plots and tables inserted.
    • The name of the report should be as follows: SASproject_groupX.pdf. The code should be sent as a separate file 
     named SASproject_groupX.sas. This code is expected to be between 300 and 400 lines.;

%let myfolder = H:\ac 2019-2020\SC\SAS\project\ ; /* thiebe folder for saving output*/

options papersize=a4 orientation = portrait 
                     bottommargin = 2cm 
                     topmargin=2cm 
                     leftmargin=1.5cm 
                     rightmargin=1.5cm; /* settings for page */
ods pdf file = "&myfolder.SASproject_group13.pdf" startpage =never style=sasweb; /* startpage = never plots everyrhing on one page */ 
ods graphics / reset=all width=30cm height=20cm ; /* settings for graph, i hope to find something similar for the table Q8*/
/* introduction */
proc odstext;
p ' ';
p 'You can use the ODSTEXT procedure to add paragraphs
   and lists to your output.';
p 'You can also format your text.' / 
     style=[just=c color=red fontsize=18pt fontweight=bold fontstyle=italic textdecoration=underline]; /* settings for text style */
p 'insert our introduction here ';
run; /* i have no idea why this resetted the page */
/* Q8 */
title 'Monthly averages of O3 data for each county';
proc tabulate data=Proj.pollutionTemp format = 8.3 out = work.meansO3;
	class County Date_Local;
	var O3_Mean O3_AQI;
	table County, Date_Local*(O3_Mean*mean O3_AQI*mean);
	label Date_Local = 'Month';
	format Date_Local MONTH12.; /* ideally we should be able to get this as.character (JAN, FEB, ...) */
run;
title;


/* Q9 */
ods pdf startpage=now; /* should ut it on new page */

proc sgplot data=work.meansO3;
	vbar County / stat=mean response=O3_Mean_Mean
	categoryorder=respdesc;
	yaxis label = 'Average Concentration O3';
run;

/* Q10 */
ods pdf startpage=now;
		
title "Continuous Heat Map option 3";
title2 "Mean O3 concentration per county per year";
proc sgplot data=work.yearmeans03;
	heatmapparm x=Date_Local y=County colorresponse=O3_Mean_Mean / 
	colormodel=(White Orange)
	outline discretex;
	label O3_Mean_Mean = "Average O3 concentration";
	gradlegend;
run;
title;

/*COMMENT: years in right order, 
ideally the county names should have longer length (possible with lenght county $ desiredlength )*/

/* Q11 */
ods pdf startpage=now; /* should ut it on new page */

title 'Yearly average O3 Air Quality Index for the top 3 countries with highest O3 concentration';

proc sgplot data=work.monthyearmeans03;
	where County in ('Adams', 'Erie', 'Lancaste');
	series x=Date_Local y=O3_AQI_Mean / group=County ;
	format Date_Local MONYY5.;
	refline 50 100 150 200 / 
		label = ('Good' 'Moderate' 'Unhealthy for some groups' 'Unhealthy');
	yaxis label = "Average O3 Air Quality Index" Min = 0 Max = 220;
	xaxis label = "Years";
run;
title;

/*COMMENT: would maybe be better if we split them over different graphs? (Think: facet_wrap(.~county) if it was in R)
it is in the course how to do this*/


/* Q12 */ 
ods pdf startpage=now; /* should ut it on new page */

title "association between temperature and O3_AQI";
proc sgplot data=Proj.pollutionTemp2015;
	reg x=O3_AQI_Mean y=Temperature_Mean_Mean /cli clm ;
	yaxis label = "Average O3 Air Quality Index" Min = 0 Max = 220;
	xaxis label = "Average temperature";
	refline 50 100 150 200 / 
		label = ('Good' 'Moderate' 'Unhealthy for some groups' 'Unhealthy');
run;

proc corr data=Proj.pollutionTemp2015 ;
   var O3_AQI_Mean;
   with Temperature_Mean_Mean;
run;
title;

ods pdf close;
